:root{
  --phi: 1.61803398875;

  --bg:#050507;
  --marble:#E8E8E8;
  --gold:#C5A059;
  --void:#080808;
  --alert:#8A0303;

  --uiNoise: 0.7;
  --uiDim: 0.0;
  --uiSkew: 0.0;
  --uiScan: 0.8;
  --uiFlicker: 0.3;
  --uiRuleBoost: 0.0;
  --uiBlur: 0.0;
}

html,body{height:100%;}
*{box-sizing:border-box;}

body{
  margin:0;
  background:
    radial-gradient(1200px 900px at 74% 26%, rgba(212,175,55,.14), rgba(0,0,0,0) 58%),
    radial-gradient(900px 700px at 28% 74%, rgba(138,3,3,.12), rgba(0,0,0,0) 56%),
    radial-gradient(1200px 900px at 70% 58%, rgba(255,255,255,.06), rgba(0,0,0,0) 62%),
    var(--bg);
  color: var(--marble);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  overflow:hidden;
  width:100vw;
  height:100vh;
}

canvas{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  display:block;
  filter: brightness(1.18) contrast(1.08) saturate(1.10);
  transform: translate3d(0,0,0);
}

body::before{
  content:"";
  position:fixed;
  inset:-60px;
  pointer-events:none;
  z-index:6;
  opacity: calc(0.03 + var(--uiNoise) * 0.16);
  background:
    repeating-linear-gradient(
      180deg,
      rgba(255,255,255,0.00) 0px,
      rgba(255,255,255,0.00) 2px,
      rgba(255,255,255,0.018) 3px,
      rgba(255,255,255,0.00) 7px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.00) 0px,
      rgba(255,255,255,0.00) 18px,
      rgba(255,255,255,0.016) 19px,
      rgba(255,255,255,0.00) 28px
    ),
    radial-gradient(1200px 900px at 44% 28%, rgba(255,255,255,0.028), rgba(0,0,0,0) 60%),
    radial-gradient(900px 700px at 76% 82%, rgba(212,175,55,0.020), rgba(0,0,0,0) 56%);
  filter: blur(calc(0.30px + var(--uiNoise) * 1.05px));
  mix-blend-mode: soft-light;
}

body::after{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:7;
  opacity: calc(var(--uiScan) * 0.22);
  background:
    radial-gradient(1200px 900px at 70% 56%, rgba(255,255,255,0.028), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(255,255,255,0.055) 48%, rgba(0,0,0,0) 100%);
  transform: translateY(calc(sin(var(--uiFlicker) * 1rad) * 1.0px));
  mix-blend-mode: overlay;
}

#loader{
  position:fixed;
  inset:0;
  z-index:50;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  gap:18px;
  color: rgba(232,232,232,.86);
  background:
    radial-gradient(1200px 900px at 74% 26%, rgba(212,175,55,.10), rgba(0,0,0,0) 58%),
    radial-gradient(900px 700px at 28% 74%, rgba(138,3,3,.10), rgba(0,0,0,0) 56%),
    linear-gradient(180deg, rgba(0,0,0,.86), rgba(0,0,0,.96));
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  letter-spacing: .18em;
  text-transform: uppercase;
  font-size:.78rem;
  text-align:center;
  transition: opacity 1.3s cubic-bezier(.16,1,.3,1);
}

.loader-bar{
  width:140px;
  height:1px;
  background:#222;
  margin-top:16px;
  position:relative;
  overflow:hidden;
}

.loader-fill{
  position:absolute;
  inset:0 auto 0 0;
  width:0%;
  background: var(--gold);
  animation: load 2.20s cubic-bezier(.22,1,.36,1) forwards;
  box-shadow: 0 0 18px rgba(212,175,55,.55);
}

@keyframes load{0%{width:0%;}100%{width:100%;}}

@media (min-width: 1100px){
  #interface{grid-template-columns: 34vw 66vw;}
  canvas{transform: translate3d(10vw,0,0) scale(1.06);}
}

@media (prefers-reduced-motion: reduce){
  body::before, body::after{opacity:0;}
  .traj-item{transition:none;}
  input[type="range"]::-webkit-slider-thumb{transition:none;}
  .stamp{display:none;}
  canvas{filter:none;}
}

@media (max-width: 820px){
  #interface{grid-template-columns: 78vw 22vw;}
  .panel-glass{
    border-right:0;
    padding: calc(7vh / var(--phi)) calc(7vw / var(--phi));
  }
  canvas{transform: translate3d(22vw,0,0) scale(1.18);}
}

#interface{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:10;
  display:grid;
  grid-template-columns: 38.2vw 61.8vw;
}

.panel-glass{
  pointer-events:auto;
  position:relative;
  border-right:1px solid rgba(255,255,255, calc(0.10 + var(--uiRuleBoost) * 0.18));
  padding: calc(10vh / var(--phi)) calc(10vw / var(--phi));
  display:flex;
  flex-direction:column;
  justify-content:center;
  transform: skewX(calc(var(--uiSkew) * -0.32deg));
  will-change: filter, transform;
  isolation:isolate;

  background:
    radial-gradient(1200px 900px at 12% 40%, rgba(255,255,255,.06), rgba(0,0,0,0) 58%),
    radial-gradient(circle at 0% 50%, rgba(14,14,18,.92) 0%, rgba(8,8,12,.72) 22%, rgba(0,0,0,0) 72%),
    linear-gradient(90deg, rgba(0,0,0,.46), rgba(0,0,0,0));

  filter:
    blur(calc(var(--uiBlur) * 0.50px))
    contrast(calc(1.0 - var(--uiDim) * 0.06))
    saturate(calc(1.0 - var(--uiDim) * 0.08));
}

.panel-glass::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:-1;
  opacity: calc(0.52 - var(--uiDim) * 0.10);
  background:
    radial-gradient(900px 700px at 18% 20%, rgba(255,255,255,.12), rgba(0,0,0,0) 48%),
    radial-gradient(900px 700px at 26% 78%, rgba(212,175,55,.07), rgba(0,0,0,0) 56%),
    radial-gradient(900px 700px at 12% 52%, rgba(138,3,3,.06), rgba(0,0,0,0) 56%);
  mix-blend-mode: screen;
  filter: blur(18px);
  transform: translateZ(0);
}

.panel-glass::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:2;
  opacity: calc(0.65 - var(--uiDim) * 0.20);
  background:
    linear-gradient(135deg, rgba(255,255,255,.16), rgba(0,0,0,0) 38%),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,0) 32%),
    linear-gradient(90deg, rgba(255,255,255,.10), rgba(0,0,0,0) 24%),
    radial-gradient(1200px 900px at 14% 46%, rgba(255,255,255,.09), rgba(0,0,0,0) 62%);
  mix-blend-mode: overlay;
  filter: blur(0.6px);
  transform: translateZ(0);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))){
  .panel-glass{
    background:
      radial-gradient(circle at 0% 50%, rgba(14,14,18,.62) 0%, rgba(8,8,12,.36) 26%, rgba(0,0,0,0) 72%),
      linear-gradient(90deg, rgba(0,0,0,.22), rgba(0,0,0,0));
    -webkit-backdrop-filter: blur(18px) saturate(1.12) contrast(1.02);
    backdrop-filter: blur(18px) saturate(1.12) contrast(1.02);
  }
}

.panel-inner{position:relative;transform: translate3d(0,0,0);}

.panel-inner::before{
  content:"";
  position:absolute;
  inset:-18px;
  pointer-events:none;
  z-index:1;
  opacity: calc(var(--uiNoise) * 0.10);
  background:
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.00) 0px,
      rgba(255,255,255,0.00) 14px,
      rgba(255,255,255,0.018) 15px,
      rgba(255,255,255,0.00) 22px
    );
  mix-blend-mode: overlay;
  filter: blur(0.30px);
}

.panel-inner::after{
  content:"";
  position:absolute;
  inset:-22px;
  pointer-events:none;
  z-index:1;
  opacity: calc(0.0 + var(--uiDim) * 0.08);
  background:
    linear-gradient(180deg, rgba(255,255,255,0.014), rgba(0,0,0,0) 42%),
    radial-gradient(900px 700px at 10% 60%, rgba(138,3,3,0.022), rgba(0,0,0,0) 60%);
  mix-blend-mode: soft-light;
  filter: blur(0.55px);
}

.kicker{
  font-size:.62rem;
  letter-spacing:.42em;
  text-transform: uppercase;
  opacity:.82;
  display:flex;
  align-items:center;
  gap:10px;
}

.kicker .dot{
  width:6px;
  height:6px;
  border-radius:50%;
  background: rgba(212,175,55,.78);
  box-shadow: 0 0 14px rgba(212,175,55,.32);
  display:inline-block;
}

h1{
  margin: 0.7rem 0 0.6rem;
  font-family: "Cinzel", serif;
  font-weight: 500;
  letter-spacing: 0.02em;
  font-size: clamp(2.4rem, 4.0vw, 4.2rem);
  line-height: 0.92;
  text-transform: uppercase;
}

.subtitle{
  font-family: "Cormorant Garamond", serif;
  font-style: italic;
  letter-spacing: 0.06em;
  opacity:0.85;
  font-size: .95rem;
}

.assertion{
  margin: 1.1rem 0 1.2rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  text-transform: uppercase;
  letter-spacing: .22em;
  font-size: .68rem;
  line-height: 1.55;
  opacity: calc(0.80 - var(--uiDim) * 0.14);
}

.gates{
  display:flex;
  gap:10px;
  margin: 0.9rem 0 1.1rem;
  flex-wrap:wrap;
  opacity: calc(0.90 - var(--uiDim) * 0.22);
}

.gate{
  position:relative;
  display:flex;
  align-items:center;
  gap:8px;
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.18);
  font-size: .64rem;
  text-transform: uppercase;
  letter-spacing: .18em;
}

.gate i{
  width:10px;
  height:10px;
  border-radius: 2px;
  display:inline-block;
  background: rgba(255,255,255,0.18);
}

.g0 i{background: rgba(212,175,55,.42);}
.g1 i{background: rgba(255,255,255,.26);}
.g2 i{background: rgba(138,3,3,.38);}
.g3 i{background: rgba(255,255,255,.18);}

.trajectory-list{
  display:flex;
  flex-direction:column;
  gap: 10px;
  margin: 1.0rem 0 1.4rem;
}

.traj-item{
  position:relative;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.10);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  letter-spacing: .14em;
  font-size: .70rem;
  text-transform: uppercase;
  cursor:pointer;
  user-select:none;
  transition: transform .28s cubic-bezier(.16,1,.3,1), background .28s cubic-bezier(.16,1,.3,1), border-color .28s cubic-bezier(.16,1,.3,1), opacity .28s cubic-bezier(.16,1,.3,1);
  opacity: calc(0.78 - var(--uiDim) * 0.12);
}

.traj-item:hover{
  transform: translateY(-2px);
  border-color: rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.04);
  opacity:1;
}

.traj-item.active{
  border-color: rgba(212,175,55,.34);
  background: rgba(212,175,55,.06);
  box-shadow: 0 0 0 1px rgba(212,175,55,.08) inset, 0 0 36px rgba(212,175,55,.10);
  opacity:1;
}

.phase-container{
  margin-top: 1.2rem;
  border-top: 1px solid rgba(255,255,255,0.08);
  padding-top: 1.2rem;
}

.phase-meta{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  letter-spacing:.16em;
  text-transform: uppercase;
  font-size: .62rem;
  opacity: calc(0.85 - var(--uiDim) * 0.14);
}

.badge{
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.18);
}

.phase-title{
  margin: 0.9rem 0 0.6rem;
  font-family: "Cinzel", serif;
  letter-spacing: .06em;
  text-transform: uppercase;
  font-size: 1.25rem;
}

.phase-desc{
  font-family: "Cormorant Garamond", serif;
  font-size: 1.08rem;
  line-height: 1.55;
  opacity: calc(0.90 - var(--uiDim) * 0.18);
  max-width: 46ch;
}

.audit{
  margin-top: 1.0rem;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.metric{
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.10);
  border-radius: 14px;
  padding: 12px 12px;
}

.metric .k{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  text-transform: uppercase;
  letter-spacing: .16em;
  font-size: .58rem;
  opacity: 0.74;
}

.metric .v{
  margin-top: 6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  letter-spacing: .12em;
  font-size: 1.0rem;
}

.stamp{
  margin-top: 1.2rem;
  width: 140px;
  opacity: calc(0.90 - var(--uiDim) * 0.22);
  filter: drop-shadow(0 0 18px rgba(138,3,3,.18));
}

.stamp svg{
  width:100%;
  height:auto;
  display:block;
}

.stamp .ring{
  fill: none;
  stroke: rgba(138,3,3,.70);
  stroke-width: 2;
}

.stamp .inner{
  fill: none;
  stroke: rgba(138,3,3,.22);
  stroke-width: 2;
}

.stamp .text{
  fill: rgba(138,3,3,.82);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
  letter-spacing: .26em;
  text-transform: uppercase;
  font-size: 10px;
}

.stamp .mark{
  fill: rgba(138,3,3,.62);
}

.controls{
  margin-top: auto;
  padding-top: 1.2rem;
}

.slider-wrap{
  position:relative;
  height: 46px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.14);
  overflow:hidden;
}

.slider-hit{
  position:absolute;
  inset:0;
  border-radius: 16px;
  pointer-events:none;
  background: linear-gradient(90deg, rgba(212,175,55,.00), rgba(212,175,55,.12), rgba(212,175,55,.00));
  opacity:0;
  transform: translate3d(0,0,0);
}

#entropy-slider{
  -webkit-appearance: none;
  appearance: none;
  position:absolute;
  left:0;
  right:0;
  top:-10px;
  bottom:-10px;
  height:auto;
  width:100%;
  background: transparent;
  margin:0;
  cursor:pointer;
  touch-action:none;
}

#entropy-slider:focus{outline:none;}

#entropy-slider::-webkit-slider-runnable-track{
  height: 66px;
  background: transparent;
}

#entropy-slider::-webkit-slider-thumb{
  -webkit-appearance:none;
  appearance:none;
  width: 30px;
  height: 66px;
  background: rgba(255,255,255,0.0);
  border:0;
  border-radius: 14px;
}

#entropy-slider::-moz-range-track{
  height: 66px;
  background: transparent;
}

#entropy-slider::-moz-range-thumb{
  height: 66px;
  background: transparent;
  border:0;
}

.slider-progress{
  position:absolute;
  inset:0 auto 0 0;
  width:0%;
  background:
    linear-gradient(90deg, rgba(212,175,55,.06), rgba(212,175,55,.14)),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,0));
  border-right: 1px solid rgba(212,175,55,.28);
  pointer-events:none;
  box-shadow: 0 0 22px rgba(212,175,55,.14);
  transform: translate3d(0,0,0);
}
