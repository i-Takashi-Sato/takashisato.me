/* Part I â€” Visualizer (Scoped) */

.visualizer-wrapper{
  --bleed: clamp(24px, 6vw, 160px);
  width: calc(100% + (var(--bleed) * 2));
  margin-left: calc(var(--bleed) * -1);
  margin-right: calc(var(--bleed) * -1);
  margin-top: 5rem;
  margin-bottom: 5rem;
  position: relative;
  z-index: 1;
}

@media (max-width: 900px){
  .visualizer-wrapper{ --bleed: 16px; }
}

.visualizer-wrapper .altrion-viz{
  --bg-void:#050505;
  --bg-panel:#0E0E0E;

  --line-struct:rgba(255,255,255,0.08);
  --line-audit: rgba(255,255,255,0.12);
  --line-tick:  rgba(255,255,255,0.10);

  --ink-head:#ffffff;
  --ink-data:#e6e4e0;
  --ink-dim:rgba(255,255,255,0.58);

  --sig-ok:rgba(255,255,255,0.12);
  --sig-warn:rgba(255,255,255,0.72);
  --sig-err:#ff3333;

  --font-auth:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  --font-audit:"JetBrains Mono","Roboto Mono","Consolas",monospace;

  --strip-width:6px;

  position:relative;
  font-family:var(--font-auth);
  color:var(--ink-data);
  background:var(--bg-void)!important;
  border:1px solid var(--line-struct)!important;
  border-radius:0!important;
  box-shadow:0 30px 80px -20px rgba(0,0,0,0.70)!important;
  isolation:isolate;
  margin:0;
  width:100%;
}

.visualizer-wrapper .altrion-viz *{
  box-sizing:border-box;
  border-radius:0!important;
}

.visualizer-wrapper .altrion-viz .altrion-top{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  padding:1.5rem 2rem;
  border-bottom:1px solid var(--line-struct);
  background:var(--bg-panel);
  position:relative;
}

.visualizer-wrapper .altrion-viz .altrion-top::after{
  content:"";
  position:absolute;
  bottom:-1px;
  left:0;
  right:0;
  height:4px;
  background-image:linear-gradient(90deg,var(--line-tick) 1px,transparent 1px);
  background-size:10px 100%;
  opacity:0.5;
  pointer-events:none;
}

.visualizer-wrapper .altrion-viz .altrion-brand h2{
  font-family:var(--font-auth);
  font-size:0.85rem;
  font-weight:600;
  letter-spacing:0.04em;
  text-transform:uppercase;
  margin:0 0 0.5rem 0;
  color:var(--ink-head);
}

.visualizer-wrapper .altrion-viz .altrion-brand p{
  font-family:var(--font-audit);
  font-size:0.7rem;
  color:var(--ink-dim);
  max-width:60ch;
  line-height:1.5;
  margin:0;
}

.visualizer-wrapper .altrion-viz .altrion-pillrow{
  display:flex;
  gap:1rem;
}

.visualizer-wrapper .altrion-viz .pill{
  font-family:var(--font-audit);
  font-size:0.65rem;
  color:var(--ink-dim);
  background:transparent!important;
  border:1px solid var(--line-struct)!important;
  padding:4px 8px;
  display:flex;
  align-items:center;
  gap:6px;
}

.visualizer-wrapper .altrion-viz .pill span{ color:var(--ink-data); }

.visualizer-wrapper .altrion-viz .dot{
  width:4px;
  height:4px;
  background:var(--ink-dim);
}

.visualizer-wrapper .altrion-viz .altrion-stage{ padding:0; }

.visualizer-wrapper .altrion-viz .altrion-grid{
  display:grid;
  grid-template-columns:1fr 340px;
  height:min(72vh, 720px);
  min-height:0;
  background:var(--bg-void)!important;
  border:none!important;
}

.visualizer-wrapper .altrion-viz .altrion-vizpane{
  position:relative;
  height:100%;
  border-right:1px solid var(--line-struct);
  overflow:hidden;
}

.visualizer-wrapper .altrion-viz .altrion-vizpane::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background-image:
    linear-gradient(var(--line-struct) 1px,transparent 1px),
    linear-gradient(90deg,var(--line-struct) 1px,transparent 1px);
  background-size:100px 100px;
  opacity:0.30;
  z-index:0;
}

.visualizer-wrapper .altrion-viz canvas{
  opacity:0.90;
  filter:grayscale(100%) brightness(1.20) contrast(1.15);
  position:relative;
  z-index:1;
}

@supports (mix-blend-mode: screen){
  .visualizer-wrapper .altrion-viz canvas{ mix-blend-mode:screen; }
}

.visualizer-wrapper .altrion-viz .banner,
.visualizer-wrapper .altrion-viz #banner{
  position:absolute;
  bottom:2rem;
  left:2rem;
  display:flex;
  flex-direction:column;
  gap:0.5rem;
  background:var(--bg-void);
  border:1px solid var(--line-struct);
  z-index:2;
  min-width:200px;
  overflow:hidden;
  padding:1rem;
  padding-left:calc(1rem + var(--strip-width));
}

.visualizer-wrapper .altrion-viz .banner::before,
.visualizer-wrapper .altrion-viz #banner::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  bottom:0;
  width:var(--strip-width);
  background:var(--sig-ok);
}

.visualizer-wrapper .altrion-viz .banner.ok::before,
.visualizer-wrapper .altrion-viz #banner.ok::before{ background:var(--sig-ok); }

.visualizer-wrapper .altrion-viz .banner.warn::before,
.visualizer-wrapper .altrion-viz #banner.warn::before{
  background:repeating-linear-gradient(0deg,var(--sig-warn),var(--sig-warn) 2px,transparent 2px,transparent 4px);
}

.visualizer-wrapper .altrion-viz .banner.collapse::before,
.visualizer-wrapper .altrion-viz .banner.fail::before,
.visualizer-wrapper .altrion-viz .banner.danger::before,
.visualizer-wrapper .altrion-viz #banner.collapse::before,
.visualizer-wrapper .altrion-viz #banner.fail::before,
.visualizer-wrapper .altrion-viz #banner.danger::before{
  background:var(--sig-err);
  width:8px;
}

.visualizer-wrapper .altrion-viz .banner .label b,
.visualizer-wrapper .altrion-viz #banner .label b{
  font-family:var(--font-auth);
  font-size:0.7rem;
  letter-spacing:0.1em;
  color:var(--ink-dim);
  text-transform:uppercase;
}

.visualizer-wrapper .altrion-viz .banner .state,
.visualizer-wrapper .altrion-viz #banner .state{
  font-family:var(--font-audit);
  font-size:0.8rem;
  color:var(--ink-head);
}

.visualizer-wrapper .altrion-viz .altrion-panel{
  display:flex;
  flex-direction:column;
  background:var(--bg-panel)!important;
  height:auto;
  min-height:0;
  overflow:visible;
  overflow-x:hidden;
  scrollbar-width:none;
  -ms-overflow-style:none;
}
.visualizer-wrapper .altrion-viz .altrion-panel::-webkit-scrollbar{
  width:0;
  height:0;
}

.visualizer-wrapper .altrion-viz .altrion-vizpane{
  overflow-x:hidden;
}

.visualizer-wrapper .altrion-viz pre,
.visualizer-wrapper .altrion-viz code{
  white-space:pre-wrap;
  overflow-wrap:anywhere;
  word-break:break-word;
  scrollbar-width:none;
  -ms-overflow-style:none;
}
.visualizer-wrapper .altrion-viz pre::-webkit-scrollbar{
  width:0;
  height:0;
}

.visualizer-wrapper .altrion-viz .block{
  position:relative;
  border-bottom:1px solid var(--line-struct)!important;
  background:transparent!important;
  box-shadow:none!important;
  padding-left:calc(12px + var(--strip-width));
}

.visualizer-wrapper .altrion-viz .block::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  bottom:0;
  width:var(--strip-width);
  background:transparent;
  transition:background 0.2s;
}

.visualizer-wrapper .altrion-viz .block:hover::before{ background:var(--line-audit); }
.visualizer-wrapper .altrion-viz .block:hover{ background:rgba(255,255,255,0.02)!important; }

.visualizer-wrapper .altrion-viz .block .hd{
  padding:12px 16px 12px 4px;
  border-bottom:1px solid var(--line-struct)!important;
  background:transparent!important;
  display:flex;
  justify-content:space-between;
  align-items:baseline;
}

.visualizer-wrapper .altrion-viz .block .hd b{
  font-family:var(--font-auth);
  font-size:0.7rem;
  font-weight:600;
  text-transform:uppercase;
  color:var(--ink-head);
  letter-spacing:0.06em;
}

.visualizer-wrapper .altrion-viz .block .hd span{
  font-family:var(--font-audit);
  font-size:0.65rem;
  color:var(--ink-dim);
}

.visualizer-wrapper .altrion-viz .block .bd{ padding:16px 16px 16px 4px; }

.visualizer-wrapper .altrion-viz .controls{ display:grid; gap:1.25rem; }

.visualizer-wrapper .altrion-viz .row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:1rem;
}

.visualizer-wrapper .altrion-viz label{
  font-family:var(--font-auth);
  font-size:0.7rem;
  color:var(--ink-dim);
  margin-bottom:0.5rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.visualizer-wrapper .altrion-viz button,
.visualizer-wrapper .altrion-viz .comboBtn{
  width:100%;
  padding:10px 12px;
  background:transparent!important;
  border:1px solid var(--line-struct)!important;
  color:var(--ink-data)!important;
  font-family:var(--font-audit);
  font-size:0.7rem;
  text-align:left;
  transition:all 0.15s ease-out;
  cursor:pointer;
}

.visualizer-wrapper .altrion-viz button:hover{
  border-color:var(--ink-head)!important;
  background:rgba(255,255,255,0.05)!important;
}

.visualizer-wrapper .altrion-viz button:focus-visible,
.visualizer-wrapper .altrion-viz input:focus-visible{
  outline:1px solid var(--ink-head);
  outline-offset:2px;
}

.visualizer-wrapper .altrion-viz input[type="range"]{
  -webkit-appearance:none;
  background:transparent;
  width:100%;
  margin:0;
}

.visualizer-wrapper .altrion-viz input[type="range"]::-webkit-slider-runnable-track{
  height:1px;
  background:var(--line-struct);
}

.visualizer-wrapper .altrion-viz input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:8px;
  height:16px;
  background:var(--ink-data);
  margin-top:-7px;
  border:none;
  box-shadow:0 0 0 1px #000;
  cursor:col-resize;
  transition:background 0.2s, transform 0.2s;
}

.visualizer-wrapper .altrion-viz input[type="range"]::-webkit-slider-thumb:hover{
  background:var(--ink-head);
  transform:scaleY(1.1);
}

.visualizer-wrapper .altrion-viz .subgrid{
  display:grid;
  gap:0;
  border-top:1px solid var(--line-struct);
}

.visualizer-wrapper .altrion-viz .gate{
  position:relative;
  padding:12px 0 12px 12px;
  border:none!important;
  border-bottom:1px solid var(--line-struct)!important;
  background:transparent!important;
  margin:0;
}

.visualizer-wrapper .altrion-viz .gate::before{
  content:"";
  position:absolute;
  left:0;
  top:0;
  bottom:0;
  width:var(--strip-width);
  background:transparent;
}

@supports (selector(:has(*))){
  .visualizer-wrapper .altrion-viz .gate:has(.badgeMini.warn)::before{
    background:repeating-linear-gradient(0deg,var(--sig-warn),var(--sig-warn) 2px,transparent 2px,transparent 4px);
  }
  .visualizer-wrapper .altrion-viz .gate:has(.badgeMini.danger)::before{
    background:var(--sig-err);
    width:8px;
  }
}

@supports not (selector(:has(*))){
  .visualizer-wrapper .altrion-viz .badgeMini.warn{
    border-left:4px solid var(--sig-warn)!important;
    border-left-style:dotted!important;
  }
  .visualizer-wrapper .altrion-viz .badgeMini.danger{
    border-left:4px solid var(--sig-err)!important;
  }
}

.visualizer-wrapper .altrion-viz .gTop{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}

.visualizer-wrapper .altrion-viz .gTitle b{
  font-family:var(--font-auth);
  font-size:0.75rem;
  color:var(--ink-head);
}

.visualizer-wrapper .altrion-viz .kv{
  display:flex;
  justify-content:space-between;
  font-family:var(--font-audit);
  font-size:0.65rem;
  color:var(--ink-dim);
  margin-top:3px;
}

.visualizer-wrapper .altrion-viz .kv .v{ color:var(--ink-data); }

.visualizer-wrapper .altrion-viz .split{
  display:grid;
  gap:1rem;
  margin-top:1rem;
}

.visualizer-wrapper .altrion-viz .case{
  border:1px solid var(--line-struct);
  padding:12px;
  background:rgba(255,255,255,0.01)!important;
}

.visualizer-wrapper .altrion-viz .caseHead b{
  font-family:var(--font-auth);
  font-size:0.7rem;
  text-transform:uppercase;
  color:var(--ink-dim);
  letter-spacing:0.06em;
}

.visualizer-wrapper .altrion-viz .stat{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  border-bottom:1px dashed var(--line-struct);
  padding:4px 0;
}

.visualizer-wrapper .altrion-viz .stat:last-child{ border-bottom:none; }

.visualizer-wrapper .altrion-viz .stat .t{
  font-family:var(--font-audit);
  font-size:0.6rem;
  color:var(--ink-dim);
}

.visualizer-wrapper .altrion-viz .stat .n{
  font-family:var(--font-audit);
  font-size:0.75rem;
  color:var(--ink-head);
}

@media (max-width:900px){
  .visualizer-wrapper .altrion-viz .altrion-grid{
    grid-template-columns:1fr;
    height:auto;
  }
  .visualizer-wrapper .altrion-viz .altrion-vizpane{
    border-right:none;
    border-bottom:1px solid var(--line-struct);
    height:min(56vh, 420px);
    min-height:360px;
  }
  .visualizer-wrapper .altrion-viz .altrion-top::after{ display:none; }
}
