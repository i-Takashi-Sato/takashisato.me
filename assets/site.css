/* =========================
   Signal Archive v2 — global
   ========================= */

:root{
  /* Color system */
  --bg0:#050505;
  --bg1:#000000;

  --fg:rgba(255,255,255,.94);
  --muted:rgba(255,255,255,.66);
  --faint:rgba(255,255,255,.28);

  --rule:rgba(255,255,255,.10);
  --card:rgba(255,255,255,.035);

  --accent:#ff0000;
  --accent2:rgba(255,0,0,.60);

  /* Layout + type */
  --max: 78ch;
  --pad-y: clamp(44px, 6.5vw, 92px);
  --pad-x: clamp(18px, 4.5vw, 30px);

  --body: clamp(16px, 1.65vw + 11px, 19px);
  --leading: clamp(1.72, 0.5vw + 1.55, 1.90);
  --h1: clamp(30px, 3.4vw + 14px, 46px);
  --h2: clamp(18px, 1.3vw + 12px, 22px);

  --scroll: 0; /* set by JS */
}

*{box-sizing:border-box}
html,body{margin:0;padding:0;overflow-x:hidden}
html{color-scheme: dark}
body{
  background:
    radial-gradient(1100px 820px at 12% -10%, rgba(255,0,0,.065), transparent 60%),
    radial-gradient(900px 700px at 95% 10%, rgba(255,255,255,.03), transparent 55%),
    linear-gradient(180deg, var(--bg0), var(--bg1) 86%);
  color: var(--fg);
  font-family: ui-serif, Charter, "Iowan Old Style", Palatino, "Hiragino Mincho ProN", "Yu Mincho", "BIZ UDPMincho", serif;
  font-size: var(--body);
  line-height: var(--leading);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-feature-settings:"palt";
}

/* Subtle grain / vignette (kept elegant) */
body::before{
  content:"";
  position:fixed; inset:0;
  pointer-events:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.55'/%3E%3C/svg%3E");
  background-size:220px 220px;
  mix-blend-mode: soft-light;
  opacity: calc(.05 + (var(--scroll) * .02));
  transform: translateZ(0);
}
body::after{
  content:"";
  position:fixed; inset:-20vh -10vw;
  pointer-events:none;
  background: radial-gradient(70% 55% at 50% 20%, transparent 35%, rgba(0,0,0,.55) 82%);
  opacity:.55;
}

/* Scroll progress */
.progress{
  position:fixed; left:0; right:0; top:0;
  height:2px; z-index:9999;
  background: linear-gradient(90deg, rgba(255,0,0,.92), rgba(255,0,0,.18));
  transform-origin:left;
  transform: scaleX(var(--scroll));
  opacity:.92;
}

/* Links + focus */
a{color:inherit; text-decoration:none; border-bottom:1px solid rgba(255,255,255,.16)}
a:hover{border-bottom-color: var(--accent2)}
a:focus-visible,
button:focus-visible,
summary:focus-visible{
  outline: 2px solid rgba(255,0,0,.65);
  outline-offset: 3px;
  border-bottom-color: rgba(255,0,0,.72);
}

.skip{
  position:absolute; left:10px; top:10px; z-index:10000;
  padding:10px 12px;
  background:#111;
  border:1px solid var(--rule);
  border-radius:10px;
  color:var(--fg);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size:12px;
  letter-spacing:.06em;
  transform: translateY(-160%);
  transition: transform .25s ease;
}
.skip:focus{transform: translateY(0)}

/* Shared top bar */
.top{
  position:sticky; top:0; z-index:50;
  backdrop-filter: saturate(140%) blur(10px);
  background: linear-gradient(180deg, rgba(5,5,5,.86), rgba(5,5,5,.54));
  border-bottom:1px solid rgba(255,255,255,.06);
}
.top-inner{
  max-width: var(--max);
  margin:0 auto;
  padding:14px var(--pad-x);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  flex-wrap:wrap;
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-variant-numeric: tabular-nums;
}
.brand{
  display:inline-flex;
  gap:10px;
  align-items:baseline;
  letter-spacing:.22em;
  text-transform:uppercase;
  font-size:11px;
  color: var(--faint);
  border-bottom:0;
}
.brand strong{letter-spacing:.08em; color: rgba(255,255,255,.70); font-weight:600}
.nav{display:flex; gap:14px; flex-wrap:wrap; align-items:center}
.nav a{border-bottom:0; color: var(--faint); font-size:12px}
.nav a:hover{color:#fff}
.sep{opacity:.25}

/* Main wrapper */
main{
  position:relative;
  max-width: var(--max);
  margin:0 auto;
  padding: var(--pad-y) var(--pad-x);
}

/* =========================
   HOME (index)
   ========================= */
body.home h1{
  margin: 10px 0 10px 0;
  font-size: var(--h1);
  font-weight: 350;
  line-height: 1.08;
  letter-spacing: .01em;
}
.hero{
  padding-top: 6px;
}
.hero .kicker{
  display:inline-flex;
  align-items:center;
  gap:10px;
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 11px;
  letter-spacing: .28em;
  text-transform: uppercase;
  color: var(--faint);
  border-bottom:0;
}
.hero .kicker .dot{
  width:6px;height:6px;border-radius:999px;
  background: rgba(255,0,0,.85);
  box-shadow: 0 0 18px rgba(255,0,0,.35);
}
.hero .who{
  margin: 12px 0 0 0;
  color: var(--muted);
}
.hero .lead{
  margin: 10px 0 0 0;
  color: rgba(255,255,255,.80);
}
.hero .meta{
  margin-top: 14px;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  align-items:center;
  font-variant-numeric: tabular-nums;
}

.section-label{
  margin: 44px 0 14px 0;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 11px;
  letter-spacing: .28em;
  text-transform: uppercase;
  border-bottom: 1px solid rgba(255,255,255,.08);
  padding-bottom: 12px;
}

/* Paper cards */
.paper-card{
  margin: 18px 0;
  padding: 18px 16px;
  border: 1px solid rgba(255,255,255,.07);
  border-radius: 18px;
  background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.0));
  box-shadow: 0 10px 40px rgba(0,0,0,.25);
}
.paper-card:hover{
  border-color: rgba(255,0,0,.16);
}
.paper-title{
  margin:0;
  font-size: var(--h2);
  font-weight: 450;
  line-height: 1.25;
}
.paper-title a{border-bottom-color: rgba(255,255,255,.18)}
.paper-title a:hover{border-bottom-color: rgba(255,0,0,.55)}

.paper-signal{
  margin: 10px 0 0 0;
  color: rgba(255,255,255,.80);
}
.k{
  display:block;
  margin-top: 8px;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  letter-spacing: .02em;
}
.k span{color: rgba(255,255,255,.70); font-weight: 600; margin-right: 8px}

.fragments{
  margin-top: 12px;
  display:grid;
  gap: 10px;
}
.fragment{
  margin:0;
  padding: 12px 14px;
  border-left: 1px solid var(--rule);
  color: var(--muted);
  position: relative;
}
.fragment::before{
  content:"";
  position:absolute; left:-1px; top:0; bottom:0; width:1px;
  background: linear-gradient(180deg, rgba(255,0,0,.0), rgba(255,0,0,.55), rgba(255,0,0,.0));
  opacity:.9;
}
.fragment .en{display:block}
.fragment .ja{display:block; margin-top: 6px; color: rgba(255,255,255,.60)}

.actions{
  margin-top: 14px;
  display:flex;
  gap: 12px;
  flex-wrap:wrap;
  align-items:center;
  font-variant-numeric: tabular-nums;
  letter-spacing:.06em;
}
.pill{
  display:inline-flex; align-items:center; gap:8px;
  padding:0;
  border:0;
  border-radius:0;
  background:transparent;
  color: var(--faint);
  border-bottom: 1px solid rgba(255,255,255,.14);
  transition: color .2s ease, border-bottom-color .2s ease;
  font-family: ui-serif, Charter, "Iowan Old Style", Palatino, serif;
  font-size: .95em;
  letter-spacing:.06em;
}
.pill:hover{
  color:#fff;
  border-bottom-color: rgba(255,0,0,.55);
}
.pill em{font-style: normal; opacity: .95}

.entry-note{
  margin-top: 18px;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
}

/* Footer */
footer{
  margin-top: 58px;
  padding-top: 26px;
  border-top: 1px solid rgba(255,255,255,.08);
  color: rgba(255,255,255,.28);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  font-variant-numeric: tabular-nums;
}
.foot-nav{display:flex; gap:14px; flex-wrap:wrap; margin-top:10px}
.foot-nav a{border-bottom:0; color: rgba(255,255,255,.34)}
.foot-nav a:hover{color:#fff}

/* =========================
   PAPER PAGES
   (works with your existing markup)
   ========================= */
body.paper h1{
  margin: 16px 0 10px 0;
  font-weight: 400;
  font-size: clamp(26px,3.2vw + 14px,40px);
  line-height: 1.12;
  letter-spacing: .01em;
}
.part{
  display:inline-flex;
  gap:10px;
  align-items:center;
  font-family: ui-sans-serif, system-ui, sans-serif;
  color: var(--faint);
  font-size: 11px;
  letter-spacing: .28em;
  text-transform: uppercase;
  border-bottom:0;
}
.part .dot{
  width:6px;height:6px;border-radius:999px;
  background: rgba(255,0,0,.85);
  box-shadow: 0 0 18px rgba(255,0,0,.35);
}

.epigraph{
  margin: 18px 0 0 0;
  padding: 14px 16px;
  border-left: 1px solid var(--rule);
  color: var(--muted);
  position: relative;
}
.epigraph::before{
  content:"";
  position:absolute; left:-1px; top:0; bottom:0; width:1px;
  background: linear-gradient(180deg, rgba(255,0,0,.0), rgba(255,0,0,.55), rgba(255,0,0,.0));
  opacity:.9;
}
.epigraph .en{display:block}
.epigraph .ja{display:block; margin-top:6px; color: rgba(255,255,255,.60)}
/* Optional “shadow” line (Part II) */
.epigraph .shadow{
  display:block;
  margin-top:10px;
  padding-top:10px;
  border-top:1px solid rgba(255,255,255,.06);
  color: rgba(255,255,255,.36);
  opacity:0;
  transition: opacity .3s ease;
}
.epigraph:hover .shadow,
.epigraph:focus-within .shadow{opacity:1}

.structure{
  margin: 16px 0 0 0;
  padding-left: 16px;
  border-left: 1px solid rgba(255,255,255,.08);
  color: rgba(255,255,255,.44);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  line-height: 1.65;
  letter-spacing: .02em;
}
.structure strong{color: rgba(255,255,255,.72); font-weight:600; letter-spacing:.06em}
.structure .arrow{opacity:.65}

.meta{
  margin-top: 14px;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  align-items:center;
  font-variant-numeric: tabular-nums;
}

.label{
  margin: 34px 0 14px 0;
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 11px;
  letter-spacing: .28em;
  text-transform: uppercase;
  border-bottom: 1px solid rgba(255,255,255,.08);
  padding-bottom: 12px;
}
.box{
  border-left: 1px solid var(--rule);
  padding-left: 16px;
  color: var(--muted);
}
.box p{margin:0 0 12px 0}
.box p:last-child{margin-bottom:0}

.grid{display:grid; gap:18px}
@media (min-width: 920px){
  .grid{grid-template-columns: 1.1fr .9fr; gap:26px}
}

ul.clean{margin:0; padding-left:18px}
ul.clean li{margin:8px 0}

details{border-left: 1px solid rgba(255,255,255,.08); padding-left: 16px}
details summary{
  cursor:pointer;
  color: rgba(255,255,255,.78);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  letter-spacing: .10em;
  list-style:none;
  margin-bottom: 12px;
  user-select:none;
}
details summary::-webkit-details-marker{display:none}
details[open] summary{color:#fff}

pre{
  margin:0;
  padding: 14px 14px;
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 16px;
  background: rgba(0,0,0,.35);
  color: rgba(255,255,255,.80);
  overflow:auto;
  font-size: 12px;
  line-height: 1.6;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-variant-numeric: tabular-nums;
}
.cite-wrap{display:grid; gap:12px}

.copy{
  justify-self:start;
  border:1px solid rgba(255,255,255,.10);
  border-radius:14px;
  padding:8px 12px;
  background: rgba(255,255,255,.02);
  color: var(--faint);
  font-family: ui-sans-serif, system-ui, sans-serif;
  font-size: 12px;
  cursor: pointer;
  transition: transform .2s ease, border-color .2s ease, background-color .2s ease, color .2s ease;
  font-variant-numeric: tabular-nums;
}
.copy:hover{
  transform: translateY(-1px);
  border-color: rgba(255,0,0,.55);
  background: rgba(255,0,0,.08);
  color:#fff;
}
.copy.is-flash{border-color: rgba(255,0,0,.7); color:#fff}

/* Mobile */
@media (max-width: 560px){
  .top-inner{padding:12px var(--pad-x)}
  pre{padding:12px 12px}
}

/* Motion safety */
@media (prefers-reduced-motion: reduce){
  *{transition:none!important; animation:none!important}
  .progress{display:none}
}

/* Print (papers become clean) */
@media print{
  html{color-scheme: light}
  body{
    background:#fff !important;
    color:#111 !important;
  }
  body::before, body::after, .progress, .top, .skip{display:none!important}
  a{border-bottom:0; color:#111}
  main{max-width: 80ch}
  .box, .epigraph, .structure, details{border-left: 1px solid #ddd}
  pre{background:#f6f6f6; color:#111; border-color:#ddd}
}
