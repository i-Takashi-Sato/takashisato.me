/* =========================================================
   HOME — V146.1: IRONCLAD GOLD MASTER (NOIR MONOLITH)
   - Layout: Phi-grid (61.8/38.2)
   - UX: 100% Clickable Card (stretched overlay) + PDF pill independent
   - Robust: Cascade-guarded (high specificity, no patch tail needed)
   - Art: Cold Platinum edges (anti-white glare)
   - Safety: --z-panel = -1 (panel never covers text)
   ========================================================= */

body.home{
  --bg-void: #050505;
  --bg-stage: #080808;
  --surface: #0E0E0E;

  --fg: #E6E4E0;
  --fg-dim: #949494;

  --accent: #D90429;
  --line: rgba(255,255,255,0.08);

  --sexy-ink: #7B001C;

  --font-serif: 'Cormorant Garamond', serif;
  --font-script: 'Pinyon Script', cursive;
  --font-sans: 'Inter', system-ui, sans-serif;
  --font-mono: 'JetBrains Mono', monospace;

  --ease-punk: cubic-bezier(0.1, 0.9, 0.2, 1.2);

  background-color: var(--bg-void);
  color: var(--fg);
  font-family: var(--font-sans);
  overflow-x: hidden;
  width: 100%;
  -webkit-font-smoothing: antialiased;
}

*{ box-sizing: border-box; margin: 0; padding: 0; }
body.home ::selection{ background: #FFF; color: #000; }

/* Noise overlay (CSP-safe) */
body.home::after{
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 50;
  opacity: 0.055;
  mix-blend-mode: overlay;
  background-image: url("/assets/noise.svg");
}

body.home main{
  max-width: 1440px;
  margin: 0 auto;
  padding: 0 max(20px, 6vw);
  border-left: 1px solid var(--line);
  border-right: 1px solid var(--line);
  background-color: var(--bg-stage);
  min-height: 100vh;
  position: relative;
  z-index: 3;
}

.vertical-axis{
  position: absolute;
  left: 15px;
  top: 400px;
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--fg-dim);
  letter-spacing: 0.6em;
  text-transform: uppercase;
  pointer-events: none;
  opacity: 0.4;
}

body.home main > header{ padding: 220px 0 120px; position: relative; }

body.home main > header h1{
  font-family: var(--font-serif);
  font-size: clamp(3.5rem, 9.5vw, 11rem);
  font-weight: 300;
  font-style: italic;
  line-height: 0.85;
  letter-spacing: -0.04em;
  margin: 0 0 80px;
}

body.home .who{
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--accent);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  margin: 0 0 20px;
  display: block;
}

body.home .lead{
  font-family: var(--font-serif);
  font-size: 1.6rem;
  line-height: 1.4;
  border-left: 4px solid var(--accent);
  padding-left: 40px;
  max-width: 850px;
  margin: 0;
}

body.home .section-label{
  display: block;
  margin-top: 90px;
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: var(--fg-dim);
  border-bottom: 1px solid var(--line);
  padding-bottom: 20px;
}

/* =========================================================
   ARCHIVE CARD — LAYER SYSTEM + CASCADE GUARD
   ========================================================= */

/* Guarded: anchor must be .paper (relative) for overlay stretching */
body.home main #archive .paper{
  display: grid;
  grid-template-columns: 61.803% 38.197%;
  column-gap: clamp(24px, 6.18vw, 96px);

  grid-template-rows: auto 1fr auto;
  grid-template-areas:
    "title  quote"
    "title  quote"
    "keys   cta";

  position: relative; /* critical anchor */

  /* Layer architecture */
  --z-kanji:   -2;
  --z-panel:   -1; /* MUST be behind text */
  --z-script:   1;
  --z-overlay: 20; /* stretched-link membrane */
  --z-cta:     30; /* independent CTA zone */

  margin-top: 100px;
  margin-bottom: 60px;
  padding: clamp(6rem, 10vw, 12rem) clamp(3.1rem, 6.18vw, 7.4rem);

  background: transparent;
  border: 0;
  overflow: visible;
  color: inherit;
  text-decoration: none;

  z-index: 1;
  align-items: start;
  isolation: isolate;

  transform: translateY(0);
  will-change: transform;
  transition: transform 0.22s var(--ease-punk);
}

/* Panel plate */
body.home main #archive .paper::after{
  content: "";
  position: absolute;
  inset: 0;
  background: var(--surface);
  border: 1px solid var(--line);
  pointer-events: none;
  z-index: var(--z-panel);

  opacity: 1;
  filter: none;

  transition:
    background-color 0.22s var(--ease-punk),
    border-color     0.22s var(--ease-punk),
    box-shadow       0.22s var(--ease-punk),
    opacity          0.22s var(--ease-punk),
    filter           0.22s var(--ease-punk);
}

/* Remove Roman numeral background (HOME only) */
body.home #archive .work-bg-num{ display: none !important; }
body.home #archive .paper:hover .work-bg-num{ display: none !important; }

/* =========================================================
   SCRIPT-NOTE (decorative)
   ========================================================= */

body.home #archive .script-note{
  position: absolute;
  z-index: var(--z-script);
  pointer-events: none;

  font-family: var(--font-script);
  font-size: clamp(8rem, 20vw, 25rem);
  line-height: 1;
  white-space: nowrap;

  color: var(--sexy-ink);
  mix-blend-mode: normal;

  --tx: 0px;
  --ty: 0px;
  --rot: 0deg;
  --scale: 1;

  transform: translate(var(--tx), var(--ty)) rotate(var(--rot)) scale(var(--scale));
  transform-origin: center center;

  opacity: 0.62;
  transition: transform 0.4s var(--ease-punk), opacity 0.3s ease;
  will-change: auto;
}

body.home #archive .paper:hover .script-note,
body.home #archive .paper:focus-within .script-note{
  --scale: 1.02;
  opacity: 0.78;
  will-change: transform, opacity;
}

body.home #archive .paper:nth-of-type(1) .script-note{
  top: 30%;
  left: 0;
  --tx: -12vw;
  --ty: -50%;
  --rot: -13deg;
  letter-spacing: -0.012em;
  text-shadow:
    -0.02em -0.015em 0 rgba(255, 220, 230, 0.12),
     0.02em  0.02em  0 rgba(80, 0, 10, 0.52),
     0.06em  0.06em  0 rgba(80, 0, 10, 0.22),
     0 0 0.20em rgba(200, 20, 50, 0.10);
}

body.home #archive .paper:nth-of-type(2) .script-note{
  top: 61.8%;
  right: 0;
  left: auto;
  text-align: right;
  --tx: 10vw;
  --ty: -62%;
  --rot: 8deg;
  letter-spacing: -0.035em;
  text-shadow:
     0.03em 0.03em 0 rgba(100, 0, 30, 0.28),
     0.07em 0.06em 0 rgba(100, 0, 30, 0.18),
     0 0 0.28em rgba(217, 4, 60, 0.12);
}

body.home #archive .paper:nth-of-type(3) .script-note{
  top: 70%;
  left: 0;
  --tx: 6.18vw;
  --ty: -30%;
  --rot: -21deg;
  letter-spacing: -0.01em;
  text-shadow:
    -0.02em -0.015em 0 rgba(255, 205, 215, 0.18),
     0.01em  0.01em  0 rgba(0, 0, 0, 0.52),
     0.06em  0.06em  0 rgba(0, 0, 0, 0.22),
     0 0 0.18em rgba(255, 60, 70, 0.10);
}

/* =========================================================
   TYPOGRAPHY & STRUCTURE (Cascade-Guarded)
   ========================================================= */

/* Guard: title container must stay static */
body.home main #archive .paper .paper-title{
  grid-area: title;
  position: static; /* critical */
  margin: 0;
}

/* Guard: anchor must stay static to avoid becoming the overlay's containing block */
body.home main #archive .paper .paper-title a{
  font-family: var(--font-sans);
  font-size: clamp(2.8rem, 5.5vw, 6rem);
  font-weight: 600;
  line-height: 0.95;
  letter-spacing: -0.04em;

  text-transform: uppercase;
  color: var(--fg);
  text-decoration: none;
  display: inline-block;

  text-wrap: balance;
  max-width: 95%;

  position: static; /* critical */
}

/* Whole-card click membrane */
body.home main #archive .paper .paper-title a::before{
  content: "";
  position: absolute;
  inset: 0;
  z-index: var(--z-overlay);
  cursor: pointer;
  background: transparent;
  display: block;
  pointer-events: auto;
}

/* Signal — styled via .paper-quote .paper-signal (see below) */
body.home #archive .paper-signal{ display:block; }

/* Keywords */
body.home #archive .k{
  grid-area: keys;
  align-self: end;
  justify-self: start;

  margin: 0;
  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.1em;

  color: rgba(230, 228, 224, 0.75);

  display: flex;
  flex-wrap: wrap;
  column-gap: 1.2em;
  row-gap: 0.5em;

  text-align: left;

  /* stay under overlay */
  position: relative;
  z-index: 1;
  pointer-events: none;
}

body.home #archive .k span{
  color: var(--accent);
  font-weight: 700;
  opacity: 0.9;
  display: inline-block;
}

/* Actions wrapper (must be above overlay) */
body.home main #archive .paper .actions{
  grid-area: cta;
  align-self: end;
  justify-self: start;
  position: relative;
  z-index: var(--z-cta);
}

/* =========================================================
   PILL (PDF) — Independent CTA (above overlay)
   ========================================================= */

body.home main #archive .paper .pill{
  margin: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.2em;

  --arrow-lane: clamp(18px, 2.2ch, 26px);
  padding: 22px calc(44px + var(--arrow-lane)) 22px 44px;

  border: 1px solid var(--line);
  color: var(--fg);
  text-decoration: none;

  position: relative;
  z-index: calc(var(--z-cta) + 1);
  pointer-events: auto;

  will-change: transform, background-color, box-shadow;
  transition:
    background-color 0.2s var(--ease-punk),
    border-color     0.2s var(--ease-punk),
    color            0.2s var(--ease-punk),
    box-shadow       0.2s var(--ease-punk),
    transform        0.2s var(--ease-punk);
}

body.home #archive .pill::after{
  content: "→";
  position: absolute;
  right: 22px;

  opacity: 0;
  transform: translateX(-10px);

  line-height: 1;
  letter-spacing: 0;
  font-weight: 700;

  transition:
    opacity   0.2s var(--ease-punk),
    transform 0.2s var(--ease-punk);
}

body.home #archive .paper:hover .pill,
body.home #archive .paper:focus-within .pill{
  background: var(--accent);
  border-color: var(--accent);
  color: rgba(255,255,255,0.98);

  box-shadow: 5px 5px 0 var(--platinum, #e0e5f0);
  transform: translate(-2px, -2px);
}

body.home #archive .paper:hover .pill::after,
body.home #archive .paper:focus-within .pill::after{
  opacity: 1;
  transform: translateX(0);
}

/* =========================================================
   HOVER: "CINEMA FOCUS" (Cold Platinum Edition)
   ========================================================= */

@media (hover: hover) and (pointer: fine){
  body.home #archive .paper:hover{
    transform: translateY(-4px);
    z-index: 100;
    cursor: pointer;
  }

  body.home #archive .paper:hover::after{
    background-color: rgba(0, 0, 0, 0.98);
    border-color: rgba(150, 162, 186, 0.18);

    box-shadow:
      0 18px 60px -14px rgba(0, 0, 0, 0.95),
      0 0 0 1px rgba(150, 162, 186, 0.045) inset;

    filter: none;
    opacity: 1;
  }

  body.home #archive .paper:hover .paper-title a{
    color: rgba(255,255,255,0.98);
    text-shadow: none;
  }
}

/* Focus (Keyboard) */
body.home #archive .paper:focus-within{
  transform: translateY(-4px);
  outline: 1px solid rgba(217, 4, 41, 0.65);
  outline-offset: 4px;
}

body.home #archive .paper:focus-within::after{
  background-color: rgba(0, 0, 0, 0.98);
  border-color: rgba(150, 162, 186, 0.18);
  box-shadow:
    0 18px 60px -14px rgba(0, 0, 0, 0.95),
    0 0 0 1px rgba(150, 162, 186, 0.045) inset;
}

/* Cinema Focus: dim others */
@supports selector(:has(*)){
  @media (hover: hover) and (pointer: fine){
    body.home #archive:has(.paper:hover) .paper:not(:hover){
      transform: translateY(0);
    }

    body.home #archive:has(.paper:hover) .paper:not(:hover)::after{
      opacity: 0.55;
      filter: blur(0.8px) grayscale(100%) brightness(0.70);
      box-shadow: none;
      border-color: rgba(255,255,255,0.04);
    }

    body.home #archive:has(.paper:hover) .paper:not(:hover) .script-note{ opacity: 0.22; }

    body.home #archive:has(.paper:hover) .paper:not(:hover) .paper-signal,
    body.home #archive:has(.paper:hover) .paper:not(:hover) .k,
    body.home #archive:has(.paper:hover) .paper:not(:hover) .actions{
      opacity: 0.55;
    }
  }

  body.home #archive:has(.paper:focus-within) .paper:not(:focus-within)::after{
    opacity: 0.55;
    filter: blur(0.8px) grayscale(100%) brightness(0.70);
    box-shadow: none;
    border-color: rgba(255,255,255,0.04);
  }

  body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .script-note{ opacity: 0.22; }

  body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .paper-signal,
  body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .k,
  body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .actions{
    opacity: 0.55;
  }
}

/* Reduced Motion Override */
@media (prefers-reduced-motion: reduce){
  body.home #archive .paper,
  body.home #archive .paper::after,
  body.home #archive .pill,
  body.home #archive .pill::after,
  body.home #archive .script-note{
    transition: none;
    will-change: auto;
  }

  body.home #archive .paper:hover .script-note,
  body.home #archive .paper:focus-within .script-note{
    --scale: 1;
    opacity: 0.62;
  }

  @supports selector(:has(*)){
    body.home #archive:has(.paper:hover) .paper:not(:hover)::after,
    body.home #archive:has(.paper:focus-within) .paper:not(:focus-within)::after{
      opacity: 1;
      filter: none;
      border-color: var(--line);
    }

    body.home #archive:has(.paper:hover) .paper:not(:hover) .script-note,
    body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .script-note,
    body.home #archive:has(.paper:hover) .paper:not(:hover) .paper-signal,
    body.home #archive:has(.paper:hover) .paper:not(:hover) .k,
    body.home #archive:has(.paper:hover) .paper:not(:hover) .actions,
    body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .paper-signal,
    body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .k,
    body.home #archive:has(.paper:focus-within) .paper:not(:focus-within) .actions{
      opacity: 1;
    }
  }
}

/* =========================================================
   NAV (as-is, kept)
   ========================================================= */

body.home .nav .nav-papers{
  position: relative;
  display: inline-block;

  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.22em;
  text-transform: uppercase;

  color: var(--fg);
  text-decoration: none;
  padding-bottom: 12px;

  opacity: 0.88;
  transition: opacity .18s ease, color .18s ease;
}

body.home .nav .nav-papers::after{
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;

  height: 2px;
  background: currentColor;

  transform: scaleX(0);
  transform-origin: left;
  transition: transform .28s ease;

  opacity: 0.85;
}

body.home .nav .nav-papers:hover,
body.home .nav .nav-papers:focus-visible{
  color: var(--accent);
  opacity: 1;
}

body.home .nav .nav-papers:hover::after,
body.home .nav .nav-papers:focus-visible::after{
  transform: scaleX(1);
}

body.home .top .nav a::after{ content: none !important; }
body.home .top .nav a{ margin-left: 0 !important; }

/* =========================================================
   JO-HA-KYU KANJI (Void Kanji) — behind panel
   ========================================================= */

body.home #archive .paper{
  --k-svg: none;
  --k-top: 61.8%;
  --k-rot: -8deg;

  --k-size: clamp(20rem, 33vw, 44rem);
  --k-opacity: 0.15;

  --k-gloss: rgba(255,255,255,0.05);
  --k-stone: rgba(0,0,0,0.60);
}

body.home #archive .paper::before{
  content: ""; /* glyph rendered as SVG */
  position: absolute;
  top: var(--k-top);
  transform: translateY(-61.8%) rotate(var(--k-rot));

  /* keep size variables; reuse as image box */
  width: var(--k-size);
  height: var(--k-size);

  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;

  /* assign per-card */
  background-image: var(--k-svg);

  opacity: var(--k-opacity);
  mix-blend-mode: normal;
  filter: blur(0.12px);

  pointer-events: none;
  z-index: var(--z-kanji);
}

body.home #archive .paper:nth-of-type(1){
  --k-svg: url('/assets/img/jo.svg');
  --k-top: 61.8%;
  --k-rot: -11deg;
  --k-size: clamp(18rem, 30vw, 40rem);
  --k-opacity: 0.16;
}

body.home #archive .paper:nth-of-type(2){
  --k-svg: url('/assets/img/ha.svg');
  --k-top: 38.2%;
  --k-rot: 8deg;
  --k-size: clamp(22rem, 38.2vw, 52rem);
  --k-opacity: 0.14;
}

body.home #archive .paper:nth-of-type(3){
  --k-svg: url('/assets/img/kyu.svg');
  --k-top: 61.8%;
  --k-rot: -7deg;
  --k-size: clamp(20rem, 34vw, 46rem);
  --k-opacity: 0.14;
}

body.home #archive .paper:nth-of-type(1)::before,
body.home #archive .paper:nth-of-type(3)::before{
  left: 0;
  transform: translate(calc(-61.8% - clamp(120px, 14vw, 280px)), -61.8%) rotate(var(--k-rot));
}

body.home #archive .paper:nth-of-type(2)::before{
  right: 0;
  transform: translate(calc(61.8% + clamp(120px, 14vw, 280px)), -61.8%) rotate(var(--k-rot));
}

/* =========================================================
   PAPER QUOTE WRAPPER (Signal + Abstract/Citation)
   - Single grid item for the "quote" area to avoid overlap
   ========================================================= */

body.home #archive .paper-quote{
  grid-area: quote;
  justify-self: start;
  align-self: start;
  position: relative;
  z-index: 1;
  pointer-events: none; /* only meta is clickable */
}

/* Signal inherits previous styling; remove grid-area from the child */
body.home #archive .paper-quote .paper-signal{
  margin: 0;
  margin-top: clamp(16px, 2.618vw, 3.6rem);

  font-family: var(--font-serif);
  font-style: italic;
  font-size: clamp(1.1rem, 1.8vw, 1.9rem);
  line-height: 1.5;
  color: var(--fg-dim);

  border-left: 0;
  padding-left: clamp(16px, 2.618vw, 30px);

  background-image: linear-gradient(
    to right,
    var(--accent) 0px 1px,
    rgba(217, 4, 41, 0.25) 1px 2px,
    transparent 2px
  );
  background-repeat: no-repeat;
  background-size: 2px 100%;
  background-position: 0 0;

  letter-spacing: -0.01em;

  /* stay under overlay */
  position: relative;
  z-index: 1;
  pointer-events: none;
}

/* Academic meta area */
body.home main #archive .paper-meta{
  margin-top: 1.618rem;                 /* φ */
  font-family: var(--font-mono);
  font-size: clamp(11px, 0.78vw, 13px);
  line-height: 1.618;                   /* φ */
  color: var(--fg-dim);
  position: relative;

  /* must be above stretched-link membrane (z=20) */
  z-index: 40;
  pointer-events: auto;
}

body.home main #archive details.abstract-toggle{
  position: relative;
  z-index: 41;
  pointer-events: auto;
}

body.home main #archive details.abstract-toggle summary{
  display: flex;
  align-items: center;
  gap: 0.618rem;                        /* φ */
  width: max-content;

  min-height: 44px;
  padding: 0.45rem 0.75rem;
  border-radius: 999px;
  border: 1px solid var(--line);

  cursor: pointer;
  user-select: none;

  background: rgba(0,0,0,0.35);
  backdrop-filter: blur(6px);

  opacity: 0.78;
  transition: opacity 0.18s, transform 0.18s, border-color 0.18s;
}

body.home main #archive details.abstract-toggle summary::-webkit-details-marker{ display: none; }
body.home main #archive details.abstract-toggle summary::marker{ content: ""; }

body.home main #archive details.abstract-toggle summary:hover{
  opacity: 1;
  color: var(--accent);
  border-color: rgba(255,255,255,0.18);
  transform: translateY(-1px);
}

body.home main #archive details.abstract-toggle summary:focus-visible{
  outline: 2px solid rgba(217,4,41,0.55);
  outline-offset: 2px;
  opacity: 1;
}

body.home main #archive details.abstract-toggle summary::after{
  content: "↘";
  opacity: 0.65;
  transform: translateY(-0.5px);
}

body.home main #archive details.abstract-toggle[open] summary::after{
  content: "↗";
  opacity: 0.85;
}

body.home main #archive .abstract-content{
  margin-top: 0.618rem;                 /* φ */
  padding: 1rem;
  border-left: 1px solid var(--line);
  background: rgba(0,0,0,0.52);
  backdrop-filter: blur(8px);
  line-height: 1.618;
}

body.home main #archive .citation{
  display: block;
  margin-top: 0.618rem;
  white-space: normal;
  opacity: 0.9;
}

/* =========================================================
   RESPONSIVE
   ========================================================= */

@media (max-width: 1024px){
  body.home #archive .paper{
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto auto;
    grid-template-areas:
      "title"
      "quote"
      "keys"
      "cta";
    gap: 40px;

    padding: 60px 24px;
    transform: none !important;
    margin-left: 0;
    width: auto;
  }

  .vertical-axis{ display: none; }

  body.home #archive .script-note{
    font-size: clamp(6rem, 25vw, 12rem) !important;
    opacity: 0.50;
    will-change: auto;
  }

  body.home #archive .paper:nth-of-type(1) .script-note{ top: 20%; --tx: -5vw; --ty: -40%; --rot: -10deg; }
  body.home #archive .paper:nth-of-type(2) .script-note{ top: 50%; --tx:  5vw; --ty: -40%; --rot:   5deg; }
  body.home #archive .paper:nth-of-type(3) .script-note{ top: 60%; --tx: -2vw; --ty: -30%; --rot: -15deg; }

  body.home #archive .paper-signal{
    margin-top: 0;
    padding-left: 20px;
    background-size: 2px 100%;
    background-position: 0 0;
  }

  body.home #archive .k{
    flex-direction: column;
    row-gap: 0.5em;
    column-gap: 0;
  }

  body.home #archive .actions{ justify-self: start; }

  body.home #archive .paper{
    --k-size: clamp(14rem, 46vw, 26rem);
    --k-opacity: 0.10;
  }

  body.home #archive .paper:nth-of-type(1)::before,
  body.home #archive .paper:nth-of-type(3)::before{
    transform: translate(calc(-38.2% - 28px), -61.8%) rotate(var(--k-rot));
  }

  body.home #archive .paper:nth-of-type(2)::before{
    transform: translate(calc(38.2% + 28px), -61.8%) rotate(var(--k-rot));
  }
}
