/* =========================================================
   V-SCRIPT: Signature Overlay (Readable + Cinematic)
   Goal:
   - Handwritten “randomness” (per-card variation)
   - NEVER blocks clicks (pointer-events:none)
   - NEVER kills readability (blend + opacity + safe hover behavior)
   ========================================================= */

/* 0) Card must be a safe stacking context */
body.home #archive .paper{
  position: relative;
  isolation: isolate;     /* z-index fights end here */
  overflow: visible;      /* allow the signature to bleed out */
}

/* 1) Content always wins (click/legibility) */
body.home #archive .paper-title,
body.home #archive .paper-signal,
body.home #archive .k,
body.home #archive .actions{
  position: relative;
  z-index: 30;            /* above script */
}

/* 2) The Signature */
body.home #archive .script-note{
  position: absolute;
  z-index: 12;            /* between bg (numeral) and content */
  pointer-events: none;   /* NEVER steals clicks */
  user-select: none;

  /* Typography */
  font-family: var(--font-script, 'Pinyon Script', 'Cormorant Garamond', serif);
  font-weight: 400;
  line-height: 0.9;
  white-space: nowrap;

  /* Size system (per-card adjustable via CSS vars) */
  font-size: calc(clamp(7rem, 16vw, 20rem) * var(--sig-scale, 1));
  letter-spacing: -0.02em;

  /* “Ink” */
  color: var(--sig-color, rgba(230,228,224,0.78));
  opacity: var(--sig-opacity, 0.22);

  /* Placement + hand-feel */
  transform:
    translate3d(var(--sig-x, 0px), var(--sig-y, 0px), 0)
    rotate(var(--sig-rot, -6deg))
    skewX(var(--sig-skew, -2deg));

  transform-origin: 50% 50%;
  will-change: transform, opacity, filter;

  /* Soft edge so it never fights the H1/button */
  filter: blur(var(--sig-blur, 0.2px));
  text-shadow:
    0 0 0.8px rgba(0,0,0,0.25),
    0 0 18px rgba(0,0,0,0.28);

  /* Blend: cinematic but safe */
  mix-blend-mode: soft-light;

  transition:
    transform .55s cubic-bezier(.19,1,.22,1),
    opacity  .35s ease,
    filter   .35s ease;
}

/* Fallback if soft-light is unsupported */
@supports not (mix-blend-mode: soft-light){
  body.home #archive .script-note{
    mix-blend-mode: normal;
    opacity: calc(var(--sig-opacity, 0.22) + 0.06);
  }
}

/* 3) Per-card “random” tuning (deterministic, but looks handwritten) */
/* Part I — Grand Design: elegant, upper-right drift */
body.home #archive .paper:nth-of-type(1) .script-note{
  --sig-scale: 1.05;
  --sig-rot:  -7deg;
  --sig-skew: -2deg;
  --sig-x:    280px;
  --sig-y:    -10px;
  --sig-opacity: 0.20;
  --sig-blur: 0.25px;
}

/* Part II — Silent Rot: huge sweep across, slightly more presence */
body.home #archive .paper:nth-of-type(2) .script-note{
  --sig-scale: 1.22;
  --sig-rot:  -4deg;
  --sig-skew: -1.5deg;
  --sig-x:    -520px;
  --sig-y:     40px;
  --sig-opacity: 0.24;
  --sig-blur: 0.18px;
}

/* Part III — Requiem: lower, calmer, closing gesture */
body.home #archive .paper:nth-of-type(3) .script-note{
  --sig-scale: 1.10;
  --sig-rot:  -9deg;
  --sig-skew: -2.2deg;
  --sig-x:     80px;
  --sig-y:    120px;
  --sig-opacity: 0.18;
  --sig-blur: 0.28px;
}

/* 4) Hover behavior: keep signature “alive” but protect CTA readability */
body.home #archive .paper:hover .script-note,
body.home #archive .paper.is-hovered .script-note{
  /* Slight parallax move, not a jump-scare */
  transform:
    translate3d(calc(var(--sig-x, 0px) + 18px), calc(var(--sig-y, 0px) - 10px), 0)
    rotate(calc(var(--sig-rot, -6deg) * 0.6))
    skewX(var(--sig-skew, -2deg));
  opacity: calc(var(--sig-opacity, 0.22) + 0.06);

  /* If it gets too sharp on hover, soften a bit to preserve text contrast */
  filter: blur(calc(var(--sig-blur, 0.2px) + 0.25px));
}

/* 5) Ultra safety: ensure button/title stay crisp regardless of blend */
body.home #archive .paper-title a,
body.home #archive .pill{
  position: relative;
  z-index: 40;
}

/* 6) Mobile: reduce chaos, keep elegance */
@media (max-width: 900px){
  body.home #archive .script-note{
    font-size: clamp(4.2rem, 14vw, 7.2rem);
    opacity: 0.16;
    mix-blend-mode: normal; /* mobile contrast stability */
    transform: translate3d(0, 0, 0) rotate(-4deg);
    left: 0.2rem;
    top: 0.2rem;
  }
  body.home #archive .paper:nth-of-type(2) .script-note{
    left: -0.6rem;
  }
}
